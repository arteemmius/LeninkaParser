<doc>
  <source auto="true" type="str" verify="true"><![CDATA[https://cyberleninka.ru/article/n/neparametricheskiy-algoritm-teksturnogo-analiza-aerokosmicheskih-snimkov]]></source>
  <category auto="true" type="str" verify="true"><![CDATA[Автоматика]]></category>
  <author auto="true" type="list" verify="true">
    <item type="str"><![CDATA[Мицель А.А.]]></item>
    <item type="str"><![CDATA[Колодникова Н.В.]]></item>
    <item type="str"><![CDATA[Протасов К.Т.]]></item>
  </author>
  <title auto="true" type="str" verify="true"><![CDATA[Непараметрический алгоритм текстурного анализа аэрокосмических снимков]]></title>
  <keywords auto="true" type="list" verify="true"/>
  <annotation auto="true" type="str" verify="true"><![CDATA[Рассмотрен новый непараметрический алгоритм текстурного анализа. Обсуждаются как вопросы влияния размера скользящего окна на результат текстурного анализа, так и вопросы выбора подмножества информативных текстурных признаков. В статье даны результаты работы рассмотренного алгоритма текстурного анализа.]]></annotation>
  <text auto="true" type="str" verify="true"><![CDATA[А.А. Мицель1, Н.В. Колодникова1,2, К.Т. Протасов2 'Томский государственный университет систем управления и радиоэлектроники 2Институт оптики атмосферы СО РАН. г. Томск E-mail: maa@asu.tusur.ru Рассмотрен новый непараметрический алгоритм текстурного анализа. Обсуждаются как вопросы влияния размера скользящего окна на результат текстурного анализа, так и вопросы выбора подмножества информативных текстурных признаков. В статье даны результаты работы рассмотренного алгоритма текстурного анализа. Введение Объектам реального мира свойственна целостность при решении задач узнавания и восприятие лишь части объекта зачастую не позволяет классифицировать их однозначно. В разделах теории по распознаванию образов показано, что привлечение контекстной информации существенно повышает качество решающих правил. Широко распространенная практика поэлементной (пиксельной) классификации аэрокосмической информации на основе их спектральных яркостей часто оказывается некорректной из-за значительной пространственной изменчивости отражательных характеристик основных классов земной поверхности. Необходимость в более эффективных методах анализа аэрокосмических изображений ставит на первый план проблему учета контекстной информации в алгоритмах распознавания образов. Если между соседними элементами изображения имеется заметная статистическая связь, она порождает локальный пространственный контекст. Источники контекстной информации могут находиться в самом изображении, выражаясь в виде определенных правил пространственной организации элементов. В этом случае целесообразно применение методов текстурного анализа для распознавания образов на изображении. Для проведения текстурного анализа необходимо: 1. Определить цель текстурного анализа. 2. Сформировать систему текстурных признаков. 3. На анализируемом изображении определить необходимое для выполнения поставленной цели количество классов и с помощью эксперта назначить образцы текстур для каждого класса. 4. Провести обучение алгоритма на текстурах-образцах и сформировать подсистему наиболее информативных текстурных признаков. 5. Используя выбранную подсистему признаков, распознать все изображение. Система текстурных признаков При компьютерном анализе аэрокосмических изображений важной характеристикой при формировании признаков служит текстура. Под текстурой понимается некоторым образом организованный локальный участок видеоданных, обладающий свойством однородности. Текстура содержит обширную информацию о поверхности и ее взаимосвязи с окружающим пространством. Основной проблемой, возникающей при решении задачи анализа текстур, является определение системы признаков для описания пространственной текстуры, присутствующей в изображении. Под признаками текстур обычно понимают характерные свойства, общие для всех текстур данного класса [1]. Текстурные признаки играют решающую роль для их классификации и при разделении изображений на отдельные области. Большое количество текстурных признаков рассмотрено в работах [2-4]. Формальной процедуры задания исходной системы признаков пока не существует. Признаки, используемые при решении тех или иных задач, задаются лишь на основании опыта и интуиции специалиста. Для распознавания спутниковых изображений нами задана следующая система текстурных признаков: Энергия: N-1N-1 т.=££р . ¡=0 у=0 где N -количество градаций яркости изображения, Р - матрица смежности [3, 5] (другое название -матрица распределения градиентов [2]). Следует заметить, что матрица смежности зависит от четырех параметров: г, у - спектральные яркости пары элементов матрицы смежности, а - направление подсчета матрицы смежности, й - расстояние между точками при подсчете матрицы смежности. Здесь и далее вместо Р(1у,а,й) будем писать просто Рц. Энтропия: N-1N-1 Т =££Р>е Р г ¡=0 ]=0 Энтропия выражает неравномерность распределения яркостных свойств элементов изображения. Максимальная вероятность: Т3 = тах Р. .. Максимальная вероятность выражает наибольшее значение в матрице смежности. к-ый начальный момент: тк=* ~2 £ £ [ / (*, .у )]к - х=1 у=1 где ^ - размер скользящего окна в пикселях, /(х,у) -яркость пикселя в точке (х,у) скользящего окна. Суммарная дисперсия: Вариация: t =Т (g -м)2 f (g), g =0 T8 = T> i=1 j = 1 \¡- J \= n. T12 =T (n - T14)2 P+ (n). где Г^) - количество пикселей с яркостью g, Л - среднее в окне (Т1). Однородность: N -1N -1 Те =££Р,у/(1+1,-. I). ,= 0 .=0 Второй угловой момент: Т =£ £ (Р,. / м )2, ,=1 .=1 где М- общее количество пар, примыкающих друг к другу элементов, (например, для й=1, а=0, M=2Ny(Nx-1), ^ N - количество элементов разрешения скользящего окна по горизонтали и вертикали соответственно). Второй угловой момент является мерой гомогенности изображения и принимает в этом случае минимальное значение. Контраст: Суммарная дисперсия служит мерой вариаций яркости относительно суммарного среднего. Суммарная энтропия: T13 =T Р+ (n)log P+(n)- Суммарная энтропия определяется классической мерой статистической теории информации и выражает неравномерность распределения яркост-ных свойств элементов изображения. Дифференциальная дисперсия: N-1 N-1 Т14 =£ [п -£ Р- (т)]2 р- (п), |, - . |= т, n=0 Контраст определяется величиной локальных вариаций яркости изображения. С увеличением числа локальных вариаций контраст возрастает. Дисперсия: т=ТТа - m)2( P, j / M), i=1 j=1 где m - математическое ожидание матрицы смежности. Дисперсия определяет вариации яркости относительно среднего значения. Момент обратной разности: T10 =ТТ[1 + (i - j)2]-1( P, j / M), i=1 J=1 Момент обратной разности тесно связан с контрастом и отражает степень разброса элементов матрицы градиентов вокруг главной диагонали. Этот признак является альтернативой контрасту в случае влияния краевых структур, поскольку относительно большие разности в значениях яркости вносят минимальный вклад в конечный результат. Суммарное среднее: 2N Tii =Т nP+(n)’ n=2 N N гдеp+(n)=YZPj/M, при i+j=n, n=2,3,...,2N-гистограмма сумм значений яркости. Суммарное среднее определяется гистограммой сумм значений яркости p+(n) по парам элементов изображения, которая непосредственно связана с матрицей смежности. где p_(n)=YLPij/M, при \i-j\=n, n=0,1,...,N-1 - гистограмма разностей значений яркостей. Дифференциальная дисперсия выражается через гистограмму разностей значений яркости p_(n) по парам элементов изображения, которая образуется из матрицы смежности. Дифференциальная энтропия: N -1 Т15 =~Т Р- («)iog Р- (")• m=0 Дифференциальная энтропия рассчитывается как суммарная энтропия, но для гистограммы разностей значений яркости. Эта система используется как библиотека текстурных признаков, из которой алгоритм выбирает наиболее информативные признаки. Все приведенные признаки вычисляются по каждому из пяти каналов прибора AVHRR спутника NOAA. Выбор размера скользящего окна Текстурные признаки зависят от размера окрестности, на которой они определяются. Размер локального фрагмента, являющегося носителем текстурных свойств, естественно определять из компромиссного желания иметь устойчивые оценки признаков, которые обеспечиваются фрагментом большого размера, и сохранить свойства однородности, обеспечиваемые небольшим фрагментом. От размера скользящего окна зависит, какие свойства ландшафтных объектов характеризуют вычисляемые текстурные признаки и в каком масштабе. Так в более крупном окне отражаются свойства текстурной однородности более крупных ландшафтных объектов, при этом влияние отдельных пикселей окна на величину текстурной оценки снижается и заметно ухудшается пространственное разрешение конечной классификации. С другой стороны, в слишком малом окне может оказаться недостаточно статистической информации для адекватного описания свойств ландшафтных объектов [6]. n=2 n=2 Выбор текстурных признаков К сожалению, не существует теории синтеза текстурных признаков, обеспечивающих, например, минимум средних ошибок распознавания. В связи с этим текстурные признаки пока изобретаются, а качество их проверяется эмпирически для конкретной задачи классификации. Поэтому оправдан такой подход: синтезировать большое количество текстурных признаков и исследовать все подмножества текстурных признаков на информативность. При всех положительных качествах текстурных признаков их основной недостаток заключается в том, что достаточно часто при анализе изображений в рамках скользящего окна будут попадаться не только однородные текстуры одного класса, но и комбинации классов и границы разделов различных текстур. В этом случае значение текстурного признака несет в себе смешанные свойства объектов подстилающей поверхности Земли и чтобы усилить роль центральных пикселов, относительно которых производятся те или иные оценки, следует расширить набор текстурных признаков добавлением спектральных компонент. Таким образом, мы получаем расширенную систему спектрально-текстурных признаков [6]. Кроме того, не все рассмотренные текстурные характеристики одинаково информативны при классификации тех или иных ландшафтных образований, поэтому для увеличения вычислительной эффективности реализующих его алгоритмов необходимо решать задачу анализа информативности и оптимизации расширенной системы признаков. Основной вопрос при построении системы признаков заключается в том, чтобы определить какие и сколько признаков необходимо выделить для надежной классификации объектов на аэрокосмическом изображении. При этом следует руководствоваться принципом учета свойств регулярности объекта - если классифицируемый объект обладает некоторой регулярностью, то эту регулярность необходимо положить в основу формирования системы признаков. Более того, необходимо учитывать, чтобы эта регулярность была присуща всем объектам, принадлежащим данному классу. Существует мнение, что нужно задавать все, что позволяет увеличить количество информации. Но это верно только в принципе. На практике же чрезмерное увеличение исходной системы признаков не приносит положительного эффекта из-за того, что степень представительности выборки одного и того же объема обратно пропорциональна размерности пространства признаков. В случае использования некоторых решающих функций добавление признаков при малой обучающей выборке может не только не улучшить, но даже ухудшить качество обучения устройства. Разумеется, при неограниченной выборке добавление признака, даже не несущего никакой информации, никогда не может ухудшить качество распознавания. В проблеме выбора информативных признаков следует выделить два основных момента, во-первых, необходимо определить функционал информативности подсистемы признаков и во-вторых, определить правило формирования последовательностей исследуемых на информативность подпространств признаков [7]. Прежде всего, заметим, что адекватным задаче оценивания качества признаков является лишь средний риск, или эмпирическая оценка последнего по обучающей выборке, то есть тот же критерий, минимизацией которого получено оптимальное (байесово) правило распознавания образов. Что касается способов выбора подпространств признаков, то разнообразие применяемых на практике способов невелико. Заметим, что решение поставленной задачи известно и тривиально: для получения оптимальной подсистемы из k признаков, выбранных среди n исходных компонент вектора наблюдения, нужно лишь произвести сравнения вычисленных на разных k-мерных подпространствах значения критерия информативности и зафиксировать тот набор к признаков, на котором выбранный критерий достигает оптимума. Количество таких подсчетов критерия оптимальности равно числу СПк - сочетаний из n признаков по к и даже для сравнительно небольших к и n составляет астрономические цифры затрат машинного времени. Ввиду сказанного, на практике широко применяются способы усеченных переборов подпространств признаков. Так в алгоритме "Del" [8], осуществляется усеченный перебор, сокращающий систему признаков путем выбрасывания одного за другим малоинформативных признаков. В другом варианте "Add" [8] система информативных признаков набирается последовательно путем включения один за другим высокоинформативных признаков. Нами реализован комбинированный алгоритм выбора информативных подпространств к признаков, представляющий собой модифицированный вариант усеченного перебора. Процесс расширения системы признаков блоками продолжается до тех пор, пока информативная совокупность i+j+...+l признаков не достигнет искомой величины к. В частном случае, полагая i=j=...=j=1, мы получим алгоритм "Add". Аналогичное обобщение допускает алгоритм усеченного перебора подпространств "Del", в котором сокращение исходной размерности n также осуществляется блоками в режиме условно полного перебора. Тем самым, предлагаемый алгоритм позволяет рассматривать дополнительные варианты пространств признаков и исследовать их на информативность. Непараметрический алгоритм текстурного анализа Пусть результатом наблюдения является совокупность оцифрованных полей видеоданных, заданных в нескольких спектральных диапазонах, так что каждый пиксел изображения подстилающей поверхности Земли и облачности, зафиксированных системой регистрации, характеризуется слу- чайным вектором Х=(Х\...,Хп)Т, где Т-знак транспонирования. Компоненты X1', 1=1,...,п (здесь и далее п - количество компонент вектора X) вектора наблюдения X характеризуют отражательные (ради-ояркостные) свойства ландшафтов и облачности в каждом спектральном диапазоне соответственно. Перед началом работы алгоритма эксперт или учитель задает N обучающих выборок Х1у,...,Х^у, то есть N - объем выборки класса V, у<еЬ для каждого из Ь классов и указывает значения компонентов вектора плана экспериментов /=(/1,...,/?)Т. При этом количество классов, количество фрагментов в каждом классе и количество и значения компонентов вектора экспериментов определяется учителем, исходя из целей задачи. Затем алгоритм из всего множества Б текстурных и спектральных признаков, заданных в программе, перебирает все подмножества признаков. Количество признаков в подмножестве определяется значением компоненты Р плана экспериментов. Используя каждое текущее подмножество признаков, алгоритм заново распределяет образцовые фрагменты по классам по минимуму среднего риска. Средний риск (эмпирический риск) оценивается по формуле: г = Х^ЕР(У)1{у = а^тахр(л)ДX) \ я)}, (1) уе1 j=l ЯеЛ где я, veT; Т - пространство классов, ТЦ1,...,Ь}, Ь - число классов; /{''истина''}=0, 7{"ложь"}=1 - характеристическая функция; и(х)=аг§ тахР(л)/(х\л) - байесово решающее правило в иной, тождественной записи, и(х) -принимаемое решение (в простейшем случае решениями могут быть элементы из Т), иеТ; У(х\/л) - условные функции плотности; Р(л) - априорная вероятность появления класса л Если неизвестны условные функции плотности, естественно использовать их непараметрические оценки /(хЯ) по обучающим последовательностям Хл,...,Хл, тогда эмпирический риск (1), для целей экономии выборки, подсчитывается методом II II -г» скользящего контроля. В качестве непараметрической оценки неизвестной функции плотности будем использовать следующую оценку с ядром Епа-нечникова с "внутренней" системой координат, обеспечивающей разворот эллипса рассеяния, согласованный с рассеянием выборочных данных [9, 10] (хТ (X - X)) ‘ 1 КК где введена следующая вспомогательная система координат и = Ох, М [ииТ ] = ОМ [ X Х]ОТ = ОЁгО1 = Л, К 0 > ' £Л Л = , О = ,0 К-, V х, О - матрица декоррелирующего ортогонального преобразования, М[.] - оператор математического ожидания, и - матрица ортогональных преобразований, X - центрированные наблюдения, Л - диагональная матрица собственных значений, Д - оценка ковариационной матрицы класса V, а=3/4^5, Ь=и/5, К - 1-ое собственное значение, к, - параметр сглаживания класса V. Особенность модифицированного ядра Епанечникова заключается в том, что единый параметр сглаживания для всех размерностей пространства наблюдений масштабируется по координатам собственными значениями К, 1=1,...,п оценочной ковариационной матрицы Д. При использовании непараметрической оценки неизвестных распределений (2) остается не доопределенным параметр сглаживания к,, таким образом, появляется возможность дополнительной адаптации вероятностных моделей образов к конкретным условиям наблюдений и обучающим выборкам. Для каждого компонента вектора плана экспериментов запоминается подмножество признаков, дающее минимальный эмпирический риск Е=(Е?,...,Е?)Т. Затем из всех минимальных рисков выбирается самый минимальный Е™ и, используя соответствующее этому риску подмножество признаков, проводится распознавание всего снимка скользящим окном. Иллюстрация работы алгоритма Для иллюстрации работы алгоритма были использованы снимки территории Томской области, зафиксированные радиометром AVHRR спутника NOAA в пяти спектральных диапазонах (1 канал -0,58...0,68 мкм, 2 канал - 0,725...1,1 мкм, 3 канал -3,55...3,93 мкм, 4 канал - 10,3.11,3 мкм, 5 канал - 11,5.12,5 мкм) с разрешением 1x1 км2 на пиксел. Целью работы алгоритма было отделение снежных покровов Земли от полей облачности для мониторинга схода снега на территории Томской области. Некоторые результаты работы приведены на рис. 1-4. На рис. 1 представлен снимок территории Томской области, полученный 9 апреля 2004 г. размером 1029x891 отсчет. Для работы алгоритма были заданы классы: "облака", "снег", "тайга" и "тепловая аномалия", в которых в качестве образцов были выделены 8, 18, 11 и 10 фрагментов соответственно. Размер скользящего окна был задан 8x8 точек (точка с координатами х=4, у=4 считалась центральной). Данный размер скользящего окна выбран как компромиссное решение между желанием использовать как можно больший участок однородной поверхности, но при этом сохранить пространственное разрешение конечной классификации. Вектор плана экспериментов состоял из девяти единиц. На рис. 2 представлен результат применения алгоритма к исходному снимку для выделения облачных полей и снежных покровов Земли. Рис. 1. Исходный снимок территории Томской области Рис. 2. Результат работы алгоритма Рис. 3. На экран отображены классы "снег" (светло-серый цвет) и "тепловая аномалия" (темно-серый цвет) на черном фоне На рис. 3 представлены два класса: "снег" и "тепловая аномалия" на черном фоне. На рисунке очень хорошо видны отроги Большого Васюганского болота, покрытые снегом, а также хорошо выделено алго- ритмом тепловое пятно на юге от Томской области. Из рисунка видно, что алгоритм уверенно отделяет подстилающую поверхность Земли, покрытую снегом, от поверхности, на которой снег уже сошел. Рис. 4. На экран отображены классы "снег" (светло-серый цвет) и "облака" (белый цвет) на черном фоне На рис. 4 представлены два класса: "снег" и "облака" на черном фоне. Визуальный анализ представленного изображения подтверждает, что алгоритм достаточно уверенно отделяет снежный покров и облачные поля друг от друга. Исходя из полученных данных, можно сказать, что на 9 апреля 2004 г. часть закрытой облаками поверхности территории, представленной на изображении, составляет 36,1 %; площади снежного покрова - 39,6 %; площади территории не занятой снегом -12,7 %. Нами была проведена оценка качества алгоритма по эмпирическому риску (1) (рис. 5). На рис. 5 по оси абсцисс для каждого значения вектора плана экспериментов отложено соответствующее ему подмножество наиболее информативных признаков из системы текстурно-спектральных признаков. То есть под 1 понимается подмножество из одного признака: вариация, посчитанная по второму каналу, под 2 - подмножество из двух признаков: вариация, посчитанная по второму каналу и энергия, посчитанная по первому каналу, под 3 - все признаки из подмножества 2 и спектральный признак четвертого канала прибора АУНЯЯ спутника NOAA, под 4 - все признаки из подмножества 3 и вариация, посчитанная по третьему каналу, под 5 -все признаки из подмножества 4 и первый начальный момент, посчитанный по третьему каналу, под 6 - все признаки из подмножества 5 и вариация, посчитанная по четвертому каналу, и, наконец, под цифрой 7 имеем следующее подмножество спектрально-текстурных признаков: вариация, посчитанная по второму каналу, энергия, посчитанная по первому каналу, спектральный признак четвертого канала прибора AVHRR спутника NOAA, вариация, посчитанная по третьему каналу, первый начальный момент, посчитанный по третьему каналу, вариация, посчитанная по четвертому каналу, спектральный признак третьего канала прибора AVHRR. По оси ординат на рис. 5 отложено соответствующее каждому подмножеству значение эмпирического риска. I 0,309 I 0,5 ■ 0,25 I 0,213 I 0,156 I 0,148 I 0,11 I 0,298 I 0,298 123456789 Рис. 5. Оценка качества подсистем текстурных признаков, посчитанная на основе эмпирического риска На кривой рис. 5 можно увидеть, что при использовании одного признака для распознавания изображения значение эмпирического риска будет равно 0,3. При добавлении еще одного наиболее информативного из оставшихся признаков значение риска возрастает до 0,5, но затем постепенно убывает вплоть до выборки из 7 текстурно-спектральных признаков. Таким образом, можно отметить, что алгоритм достигает наилучших результатов при наборе из семи наиболее информативных признаков. Дальнейшее добавление признаков только ухудшает качество распознавания изображения. Из анализа кривой рис. 5 можно сделать вывод, что меньшее количество признаков не всегда приводит к лучшему качеству распознавания. В то же время очень большое количество признаков может ухудшить качество распознавания изображения. Поэтому количество признаков в подсистеме, обеспечивающей наилучшее качество распознавания, не должно задаваться человеком перед запуском алгоритма, а должно находиться алгоритмом в зависимости от значений эмпирического риска. ]]></text>
</doc>
