<doc>
  <source auto="true" type="str" verify="true"><![CDATA[https://cyberleninka.ru/article/n/programmnye-sredstva-temperaturnogo-zondirovaniya-zemnoy-poverhnosti-s-pomoschyu-rtm-metoda]]></source>
  <category auto="true" type="str" verify="true"><![CDATA[Автоматика]]></category>
  <author auto="true" type="list" verify="true">
    <item type="str"><![CDATA[Соломатов Дмитрий Владимирович]]></item>
  </author>
  <title auto="true" type="str" verify="true"><![CDATA[Программные средства температурного зондирования земной поверхности с помощью RTM-метода]]></title>
  <keywords auto="true" type="list" verify="true">
    <item type="str"><![CDATA[rtm-метод]]></item>
    <item type="str"><![CDATA[температура земной поверхности]]></item>
    <item type="str"><![CDATA[атмосферная коррекция]]></item>
    <item type="str"><![CDATA[программный комплекс]]></item>
    <item type="str"><![CDATA[априорная информация]]></item>
  </keywords>
  <annotation auto="true" type="str" verify="true"><![CDATA[Рассматриваются вопросы реализации программного комплекса для температурного зондирования земной поверхности с помощью RTM-метода. Подход основан на использовании модели переноса излучения для атмосферной коррекции спутниковых ИК-измерений. Разработана общая структура программного комплекса, осуществлен анализ существующих программных средств. Реализованы программные средства для получения априорной информации по спутниковым данным и проведена их валидация. Представлена реализация программного комплекса для оперативного восстановления температуры земной поверхности.]]></annotation>
  <text auto="true" type="str" verify="true"><![CDATA[Д.В. Соломатов Институт оптики атмосферы им. акад. В.Е. Зуева СО РАН, г. Томск E-mail: solomatov@iao.ru Рассматриваются вопросы реализации программного комплекса для температурного зондирования земной поверхности с помощью RTM-метода. Подход основан на использовании модели переноса излучения для атмосферной коррекции спутниковых ИК-измерений. Разработана общая структура программного комплекса, осуществлен анализ существующих программных средств. Реализованы программные средства для получения априорной информации по спутниковым данным и проведена их валидация. Представлена реализация программного комплекса для оперативного восстановления температуры земной поверхности. Ключевые слова: RTM-метод, температура земной поверхности, атмосферная коррекция, программный комплекс, априорная информация. Key words: RTM-method, earth surface temperature, atmospheric correction, bundled software, a priori information. Температурное зондирование земной поверхности из космоса позволяет получать важную информацию о происходящих физических, химических и биологических процессах, решать актуальную проблему оперативного обнаружения и мониторинга чрезвычайных ситуаций: пожары, вулканы, землетрясения и т. д. Для мониторинга больших территорий целесообразно использовать спутниковые данные, в том числе данные систем EOS MODIS и NOAA POES. Сигнал, измеренный в канале спутникового прибора с длиной волны Я, может быть представлен следующим образом: Ls (Я) = Lsrf (Я) + Latm (Я) + +Lrfl (Я) + LSCT (Я)+ Ladj (Я), где Ь(Я) - излучение, измеренное в канале прибора; LS¡uj(%) - искаженное атмосферой тепловое излучение поверхности; LATM(X) - тепловое излучение атмосферы; Lm(%) - излучение, отраженное от поверхности; LSCT(X) - рассеянное атмосферной излучение; Lm(X) - вклад «бокового подсвета». Величина LSM(X) в свою очередь может быть записана как: LSrf(Я) = sя • В[Я,TSRF ] • Ря(6у ,0, H), где sx - излучательная способность поверхности; РЯ(вг,0,И) - функция пропускания атмосферы; В[Я,Т5]№] - функция, обратная функции Планка; TSSF - температура поверхности. Таким образом, задача восстановления температуры земной поверхности (ТЗП) заключается в исключении из измеренного сигнала величин LATM, Lm, LSCT, Ladj, нахождении функции пропускания Д, определении LSSF и восстановлении с помощью функции, обратной функции Планка, температуры поверхности TSSF. В настоящее время для восстановления ТЗП по данным спутниковых систем используется спектральный метод (SW-метод) [1, 2], основанный на линейных соотношениях между ТЗП и измерениями в каналах прибора в области длин волн 11 и 12 мкм и ^2) окна прозрачности атмосферы, а также излучательной способности (е11 и е12): т + т т — т 7^ = С + а 11 ±12 +в±п ±12 , а — Ai + A2 1-s .As + A3—, ß — B1 + B2 + B. 3 s2 s — S11 +S12 As — si1 si2 Коэффициенты Ai и Bi определяются на основе данных совместной статистической обработки наземных и спутниковых измерений или результатов имитационного моделирования спутниковых измерений ТЗП и зависят от угла наблюдения, общего влагосо-держания и температуры приземного слоя атмосферы. Основным преимуществом данного подхода является его простота и высокая скорость обработки. Однако данный метод имеет ряд существенных недостатков, основным из которых является то, что в рамках алгоритма производится учет поглощения теплового излучения водяным паром, но отсутствует учет искажений, вызванных аэрозолем и перистой облачностью. Для решения этой проблемы может быть использован RTM-метод (Radiative Transfer Model) (рис. 1), основанный на применении моделей переноса излучения для атмосферной коррекции. Следует отметить, что методика RTM-метода не является новой и известна достаточно давно. Однако областью применения RTM-метода традиционно является видимый диапазон. Помимо этого в качестве априорной информации принято использовать статические базы данных оптических и метеорологических характеристик атмосферы и прогностические метеоданные. В статье представлены результаты использования в качестве априорной информации оперативных спутниковых данных. Априорная информация об оптико- Измеренная прибором Излучательная метеорологическом состоянии интенсивность способность атмосферы излучения, LS поверхности, £х Рис. 1. Общая схема RTM-метода Методические вопросы применения моделей переноса для коррекции ИК-измерений исследованы в работах [3, 4]. Из результатов этих исследований следует, что практическая реализация указанного подхода позволит обеспечить более надежное и универсальное решение проблемы коррекции ИК-измерений в более широком диапазоне оптико-метеорологических условий спутниковых наблюдений. Ключевыми условиями эффективной реализации RTM-метода являются: • радиационная модель, точность которой удовлетворяет задачам атмосферной коррекции ИК-измерений; • необходимый объем оперативной априорной информации о состоянии атмосферы в момент спутниковых измерений; Спутниковые измерения ] I этап. «Первичная обработка» Распаковка, калибровка, геопривязка Статические данные J Калиброванные спутниковые измерения Данные географической привязки L -Л Вспомогательные данные J П этап. «Априорная; Статические данные информация» ................... «Облачная маска» Аэрозольная оптическая толща, общее влагосодержание, атмосферные профили температуры и влажности, характеристики облачности I Тематические данные - априорная информация для атмосферной коррекции j III. Jldil. «Л1МОСфсрНаЯ коррекция» «Искажающие характеристики» «Восстановление ТЗП» ) Л Восстановленная ТЗП Тематические задачи Рис. 2. Структурная схема программного комплекса • «быстрое» программное обеспечение для тематической обработки спутниковой информации. Таким образом, разработка новых (или адаптация имеющихся) программных средств, обеспечивающих эффективное применение RTM-метода для атмосферной коррекции ИК-измерений, предполагает, что указанное программное обеспечение должно решать следующие задачи: • Первичная обработка, калибровка, географическая привязка спутниковых данных. • Получение априорной информации об оптическом и метеорологическом состоянии атмосферы. • Расчет искажающих характеристик атмосферы на основе априорной информации. • Атмосферная коррекция и восстановление ТЗП. Помимо этого, программный комплекс должен иметь максимальное быстродействие для решения задачи оперативного мониторинга и иметь удобный графический интерфейс, позволяющий пользователю работать с программным комплексом без специальной подготовки. Исходя из поставленных задач, была разработана структура программного комплекса (рис. 2). Алгоритм восстановления ТЗП можно разбить на 3 логических этапа, которые выполняются соответствующими блоками программного комплекса. На первом этапе с помощью блока «Первичная обработка» осуществляется распаковка спутниковых данных, их калибровка и географическая привязка. На втором этапе блоком «Априорная информация» осуществляется подготовка оперативной априорной информации о параметрах состояния атмосферы, включающей: облачную маску, оптические характеристики аэрозоля, интегральное влагосодер-жание атмосферы, характеристики облачности, вертикальные профили геопотенциала, температуры и влажности воздуха, содержания озона. На третьем этапе на основе априорной информации, сформированной на этапе 2 блоком «Атмосферная коррекция», производится расчет характеристик искажающего влияния атмосферы LATM, Lm, LSCT, Ladj, функции пропускания Px и осуществляется восстановление ТЗП. В настоящие время разработано множество программных средств обработки данных дистанционного зондирования, которые рассматриваются в [5]. При разработке программного комплекса проводился сравнительный анализ существующих программных средств и рассматривалась возможность их использования для решения поставленной задачи. Основными условиями для использования готовых программных продуктов являлись свободное распространение и наличие исходных кодов. Так, при анализе программных средств первичной и тематической обработки данных систем EOS MODIS и NOAA POES можно выделить программные продукты, приведенные в таблице. Таблица. Программные средства первичной и тематической обработки данных Наименование ПО/Разработчик Назначение Условия распространения, наличие исходного кода Спутниковая система EOS MODIS Product Generation Executive (PGE)/GSFC (Goddard Space Flight Center) Первичная обработка, получение априорной информации Ограниченное IMAPP Level 1 (International MODIS/AIRS Processing Package)/Space Science and Engineering Center (SSEC) University of Wisconsin-Madison IMAPP Level 2/SSEC Получение априорной информации Свободное (GPL), в наличии Спутниковая система NOAA POES AAPP (ATOVS and AVHRR Pre-processing Package) [6]/EUMET-SAT Satellite Application Facility on Numerical Weather Prediction (NWP SAF) Первичная обработка Разрешено использование, в наличии IAPP (International ATOVS Processing Package) [7]/Cooperative Institute for Meteorological Satellite Studies, University of Wiscon-sin-Madison Получение априорной информации Свободное (GPL), в наличии Таким образом, при реализации программного комплекса в качестве основы для блока «Первичная обработка» было решено использовать программное обеспечение IMAPPW для MODIS и aApP для NOAA; для блока «Априорная информация» -IMAPp Level 2 для MODIS и IAPP для NOAA. Что касается выбора модели переноса излучения, то существуют модели, позволяющие производить расчет искажающих характеристик с высокой точностью (Line-By-Line методом), в частности программный комплекс LBLRTM. Однако использование этих программ на практике осложняется большой трудоемкостью вычислений, что делает этот метод не пригодным для обработки больших объемов спутниковой информации. Поэтому необходимо применять проверенные практикой и доступные широкому пользователю упрощенные модели переноса излучения. Среди этих моделей такие широко известные программные средства, как LOWTRAN7, MOD-TRAN, 6S, ATCOR. Однако, программное средство LOWTRAN7 имеет недостаточное спектральное разрешение, 6S предназначено для расчета характеристик в видимом диапазоне, а ATCOR - коммерческое программное обеспечение, которое распространяется без исходных кодов. Таким образом, в качестве модели переноса излучения было выбрано программное средство MODTRAN. В настоящее время программа MODTRAN_v4.x является коммерческим продуктом. Но её предыдущая вер- Первичная обработка Свободное (GPL), в наличии сия MODTRAN_v3.x и исходные коды доступны пользователю. Сравнение результатов работы программных средств MODTRAN_v3.5 и LBLRTM_v11.3 [8] показывает, что различия в полученных значениях температур на превышают 0,15 K, а это вполне удовлетворяет практическим требованиям к точности восстановления ТЗП из космоса. К основным недостаткам пакета IMAPP Level 2 относится то, что процесс распаковки данных занимает продолжительное время (30...50 % от общего времени работы пакета, в зависимости от типа HDF-файлов), а распакованные данные занимают дополнительно более 1 Гб дискового пространства для одной гранулы, что существенно при обработке большого количества гранул. В связи с этим при разработке блока «Априорная информация» было решено внести ряд изменений в эту схему в целях ускорения процесса обработки данных. В частности, было решено отказаться от распаковки в бинарный формат и производить чтение напрямую из HDF-файлов. Для этого была создана динамическая библиотека, в которой реализована предварительная подкачка нескольких сканов и их выдача по запросу модуля. Таким образом, распаковка производится не для каждого скана, а один раз для нескольких. Так, при установке количества подкачиваемых сканов 20 общее время работы блока сократилось приблизи- тельно в 5 раз. Данная реализация также позволяет настроить программный блок таким образом, чтобы производить однократное чтение данных, хранение их в памяти и выдачу модулям блока по запросам. При таком подходе объем используемой памяти составляет порядка 1 Гб, однако общее время работы блока уменьшится приблизительно в 10 раз по сравнению с первоначальной версией. Для проверки работы блока «Априорная информация» была проведена валидация полученных характеристик атмосферы, результаты которой представлены на рис. 3. В качестве тестовых данных использовались данные PGE LAADS Web [9] и SSEC University of Wisconsin-Madison. Для оценки результатов валидации использовались доступные в литературе [10-12] оценки методической погрешности спутниковых методов восстановления и результаты моделирования влияния оптико-метеорологических параметров на спутниковые измерения. Как видно из этих результатов, расхождения лежат в пределах методической погрешности методов восстановления и удовлетворяют требованиям RTM-метода к качеству априорной информации. Таким образом, блок «Априорная информация» обеспечивает получение оптико-метеорологических характеристик по спутниковым измерениям достаточного объема и качества для применения RTM-метода. Y Y 0,4 0,3 0,2 0,1 Аэрозольная оптическая толща, ~ относит ед. Q Среднее = 1*10-4 СКО = 1*10"4 R = 0,999 0,250,200,150,10: 0,050,00 -0,05: -0,10: -0,15-0,20: 300 295: 290: 285: 280: Система EOS MODIS Вертикальные профили температуры, (уровень 1000 I Среднее = 0,34 СКО = 0,82 R = 0,98 Y 2.5 2,0 1.5 1,0 0,5 Общее влагосодержание, см 0,1 Y 0,2 0,3 АОТ 0,63 мкм 0,4 X Средняя разница СКО разницы 280 285 290 295 300 X Y Система NOAA POES 4,5 j Общее влагосодержание 4,0 0,0 0,0 0,5 1,0 1,5 2,0 2,5 X I Вертикальные профили (уровень 1050 мб) < Среднее = 0,04 СКО = 1,26 R = 0,97 190 200 210 220 230 240 250X 1,5 2,0 2,5 3,0 3,5 4,0 4,5X 280 285 290 295 300 305 310 X Рис. 3. Валидация блока «Априорная информация» (по оси X - тестовые данные, по оси Y - результаты работы программного комплекса) Рис. 4. Графический интерфейс пользователя Помимо этого, одним из важнейших компонентов любого современного программного комплекса является интерфейс пользователя. Интерфейс пользователя должен быть простым, удобным и понятным для пользователя, но в то же время обеспечивать возможность задания всех необходимых для работы программного комплекса параметров, контроля пользователем процесса выполнения обработки и просмотра входных и выходных данных. Разработанный графический интерфейс (рис. 4) позволяет пользователю задавать входную информацию и параметры обработки и контролировать процесс обработки, осуществляет взаимодействие между блоками и модулями программного комплекса. Следует заметить, что для получения разных продуктов MODIS и NOAA требуются разные входные данные. При задании пользователем списка требуемых продуктов программа автоматически определяет необходимый набор входных данных и выводит в правой части окна поля ввода только для этих данных. При задании входных данных для удобства пользователя также реализован автоматический поиск файлов. Так, при выборе пользователем одного из требуемых файлов программа пытается автоматически найти остальные. Выводы 1. Предложен алгоритм восстановления температуры земной поверхности с помощью RTM-метода с использованием в качестве априорной информации об оптико-метеорологическом состоянии атмосферы оперативных данных, полученных по спутниковым измерениям. 2. Разработано и реализовано оригинальное программное обеспечение, использующее на практике теоретические разработки в области восстановления температуры земной поверхности на основе RTM-метода по данным спутниковых систем EOS MODIS и NOAA POES. 3. Проведена валидация блока восстановления априорной информации об оптико-метеорологическом состоянии атмосферы, показано соответствие результатов его работы требованиям RTM-метода. 4. Реализованный подход, в отличие от стандартного подхода к восстановлению температуры земной поверхности позволяет в явном виде учитывать оптическое и метеорологическое состояние атмосферы. Автор выражает благодарность к.ф.-м.н. С.В. Афонину и д.ф.-м.н. В.В. Белову за интерес к работе и консультационную поддержку. ]]></text>
</doc>
