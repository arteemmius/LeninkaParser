<doc>
  <source auto="true" type="str" verify="true"><![CDATA[https://cyberleninka.ru/article/n/avtomaticheskaya-annotatsiya-izobrazheniy-na-osnove-globalnyh-priznakov]]></source>
  <category auto="true" type="str" verify="true"><![CDATA[Автоматика]]></category>
  <author auto="true" type="list" verify="true">
    <item type="str"><![CDATA[Мельниченко Александра Сергеевна]]></item>
  </author>
  <title auto="true" type="str" verify="true"><![CDATA[Автоматическая аннотация изображений на основе глобальных признаков]]></title>
  <keywords auto="true" type="list" verify="true">
    <item type="str"><![CDATA[АВТОМАТИЧЕСКАЯ АННОТАЦИЯ ИЗОБРАЖЕНИЙ]]></item>
    <item type="str"><![CDATA[ПОИСК ИЗОБРАЖЕНИЙ]]></item>
    <item type="str"><![CDATA[ПРИЗНАКИ ИЗОБРАЖЕНИЙ]]></item>
    <item type="str"><![CDATA[ВЕРОЯТНОСТНЫЕ МОДЕЛИ]]></item>
    <item type="str"><![CDATA[ЯЗЫКОВЫЕ МОДЕЛИ]]></item>
    <item type="str"><![CDATA[АUTOMATED IMAGE ANNOTATION]]></item>
  </keywords>
  <annotation auto="true" type="str" verify="true"><![CDATA[В данной работе рассматривается проблема автоматического аннотирования изображений с целью описания изображений набором ключевых слов, позволяющих осуществлять поиск по текстовому запросу в больших коллекциях изображений. Построенная в результате анализа, сравнения и модификации эффективных современных методов представления и поиска изображений модель аннотирования алгоритмизована и реализована программно, найдены оптимальные наборы параметров.]]></annotation>
  <text auto="true" type="str" verify="true"><![CDATA[В данной работе рассматривается проблема автоматического аннотирования изображений с целью описания изображений набором ключевых слов, позволяющих осуществлять поиск по текстовому запросу в больших коллекциях изображений. Построенная в , -ставления и поиска изображений модель аннотирования алгоритмизована и реализована , . Автоматическая аннотация изображений; поиск изображений; признаки изображений; вероятностные модели; языковые модели. A.S. Melnichenko AUTOMATIC IMAGE ANNOTATION BASED ON GLOBAL IMAGE FEATURES The problem of automated image annotation is considered in this work. The task is introduced and solved under the assumption of further application of its results to the problem of retrieval large collections of images. Existing methods are reviewed and analyzed their advantages and disadvantages. The task is splitted into stages and the most effective method through the existing and improved solutions is proposed for each stage. The program implementation have been done for all major stages of the concidered methods of image annotation. utomated image annotation; image retrieval; image processing; image features; probability models; language models; language smoothing. Автоматическая аннотация изображений - это процесс автоматического присвоения системой метаданных в форме заголовка или ключевых слов цифровому изображению на основании только визуальной информации, содержащейся в изо. помощью слов визуальной информации содержащейся на изображении (как низкоуровневой информации, связанной с цветами, текстурами изображения, так и высокоуровневой, связанной с семантикой изображения). Автоматическая аннотация изображений является очень востребованной в последние годы областью компьютерного зрения в связи с ее потенциальным влиянием на понимание изображений и веб-поиск. Предпосылки и проблемы автоматической аннотации изображений Сегодня, в связи с развитием мультимедийных технологий, у пользователей и организаций появились огромные базы данных изображений. Общее же количество изображений в Интернете оценивается величиной 1010 и с каждым годом уд. управления большими коллекциями изображений, семантической классификации и быстрого и точного поиска нужных пользователю изображений. * Работа выполнена при финансовой поддержке РФФИ, проект №08-07-00129, №07-0700067. На сегодняшний день существует два основных подхода к поиску изображений: поиск на основе текстового запроса и поиск на основе визуального образца. В первом случае в качестве запроса выступает набор ключевых слов, и система должна вернуть наиболее удовлетворяющие им изображения. Во втором случае в качестве запроса выступает изображение-образец (например, нарисованное от руки, сканированное или изображение низкого качества), а система находит все подобные ему изображения. Главными областями применения подхода поиска на основе визуального образца являются те, где важнее найти визуальное сходство изображений: поиск в медицинских коллекциях, например, среди рентгеновских снимков; поиск в дизайнерских коллекциях, когда дизайнер ищет некоторое подходящее по цветовой гамме и текстуре изображение; поиск в архивах правоохранительных органов интересующих криминалистов лиц или объектов. Поиск по текстовому запросу более удобен для пользователя и обычно применяется там, где более важна семантика искомого изображения. Во многих случаях поиск по текстовому запросу является единственным приемлемым для пользователя вариантом поиска (например, когда у пользователя нет образца изображения, похожего на , - , ). -ностью поиска по текстовому запросу является то, что для его проведения все изображения в коллекции должны иметь текстовые описания: ключевые слова, тэги. Но ручное аннотирование столь больших объемов изображений - слишком трудоемкий процесс. В связи с этим с конца 90-х гг. началась активная разработка методов автоматического аннотирования изображений. С появлением методов автоматического аннотирования ручное аннотирование множества изображений перестает быть необходимым, что позволяет включить в поиск большее количество картинок и улучшить его качество. В настоящее время также производятся попытки решить проблему субъективности аннотаций, зависимости от языка путем введения единого словаря понятий и применением различных лингвистических технологий. Наиболее важная область применения такого поиска - это поиск в Интернете, поэтому разработка методов автоматического аннотирования является весьма актуальной задачей. animal tiger snow natural winter landscape castle lake forest tree Puc. 1. Пример автоматического присвоения ключевых слов изображениям Обработка изображений, кроме технических особенностей (трудностей хранения и обработки больших объемов данных), обладает своей спецификой, коренным образом отличающей ее от обработки текстовой информации. Поэтому разработка эффективных методов навигации и поиска в больших базах данных изобра-, удовлетворительного решения задачу. Основной проблемой, затрудняющей эффективное и однозначное решение проблемы поиска в коллекции изображений, является так называемая проблема «сшанттеского разрыва.» — отсутствия однозначной связи между низкоуровневыми характеристиками и семантикой изображения. Критерий сходства, вводимый на основании числовых значений пикселов изображений или полученных на их основе производных характеристик, не в состоянии уловить семантику запроса, подразумеваемую пользователем. Подобные проблемы, связанные со смысловой неопределенностью, возникают также и в системах автоматизированной смысловой обработки текстов. Проблема же семантического разрыва в области обработки изображений является намного более сложной, так как она должна быть решена не в рамках естественного языка, а в рамках весьма неоднозначной связи языка и визуальных характеристик изображений. Попытки преодолеть проблему семантического разрыва влекут существование множества разнообразных представлений визуальных характеристик изображений. Одной из проблем автоматического аннотирования также является выбор представления , -, . Ещё одной трудностью, связанной с созданием баз изображений, является от, , - . поиска. Кроме того, методы автоматического аннотирования изображений обычно требуют обучения на коллекции изображений, имеющих аннотации. В связи с этим возникают некоторые дополнительные проблемы. Различные коллекции изображений аннотируются разными наборами слов с использованием различных правил. Из-за больших различий в специфике обучающей коллекции и той коллекции, на которой будет применена построенная модель, ее работа может быть некорректна. В дополнение ко всему, пользователь, которому направлены результаты аннота-, , слов. Поэтому построение подходящего словаря ключевых слов, задействованного в модели автоматического аннотирования, также является важной задачей. Этапы решения задачи автоматического аннотирования изображений Задачу автоматической аннотации изображений можно разбить на три этапа: 1. Разработка представления визуальных признаков изображений, составление словаря этих признаков: В = {Ъ1,Ъ2,...,Ъы}, где bi, / =1,...,N - один из выбранных признаков изображения. 2. Составление обучающей выборки Q = {/1,/2,..., /К}аннотированных , Ж = {^,..., ^ }. 3. Условимся также в дальнейшем обозначать / е Q - изображение из обучающей выборки, а J £ Q — новое неаннотированное изображение не из обучающей выборки, для которого мы хотим построить аннотацию. 4. Построение математической вероятностной модели МВ Ж, описывающей взаимосвязи слов из Ж с визуальными признаками из В путем нахождения совместного распределения Р(w, /) для каждого слова W из словаря ключевых слов и каждого изображения / из обучающей выборки, оценка параметров модели по обучающей выборке Q. Все эти три этапа очень важны для эффективной работы алгоритма. , - ального содержания изображений, выделяющих важные для восприятия человеком характеристики изображений и позволяющих определять сходство и различие изо, - ботки изображений и, в частности, методов автоматической аннотации. Принято различать региональное (основанное на локальных характеристиках отдельных ) ( -лом) представления изображений. Так, региональное представление используется в таких моделях, как Co-occurrence Model[1], Translation Model[2], Cross-Media Relevance Model[3, 4], а глобальное в Global image features and nonparametric density estimation[5] и Automatic linguistic indexing model[6]. При этом в первых трех моделях не ставилась целью разработка признаков изображений, а использовалось го. представляет собой весьма трудную задачу. В то же время в последних двух моделях, нашедших практическое применение в поисковых системах Behold1 и ALIPR2, а также в моделях глобального аннотирования[7], с успехом применяются глобальные признаки изображений. В работах [8, 9] также показывается связь глобальных признаков с человеческим восприятием изображений, важность цветовых и текстурных характеристик. Исходя из всего этого использование глобальных признаков можно считать перспективным. Поэтому в данной работе в качестве первого этапа решения поставленной задачи рассматривается разработка методов выделения глобальных признаков изображений с использованием актуальных техник машинного зрения. Выборка аннотированных изображений, используемая для обучения, также имеет большое значение для методов автоматической аннотации. Необходимо, чтобы аннотации изображений в обучающей выборке были полными, для каждого изображения было определено несколько ключевых слов. Множество слов, встречающихся в аннотациях изображений обучающей выборки, составляют словарь ключевых слов W. Необходимо, чтобы слова словаря были представлены в обучающей выборке достаточным для оценки некоторой выбранной модели количеством и чтобы размер словаря ключевых слов не превышал размер словаря визуаль-. , -нове базы аннотированных изображений mirflickr3, состоящей из изображений пользователей он-лайн сервиса www.flickr.com и содержащей пользовательские аннотации на 7 различных языках. В результате составления удовлетворяющей описанным выше требованиям обучающей выборки размер полученной выборки составил | Q | = 2500, размер словаря ключевых слов | W | = 50 (в связи со специ). , , аннотации является выбор модели, которая будет ставить в соответствие визуальным признакам изображений слова. Вероятностные методы применительно к автоматическому аннотированию изображений представляют собой расширение моделей для поиска текста [10] с учетом особенностей изображений. Большинство используемых для автоматического аннотирования изображений методов являются 1 http://behold.cc - он-лайн система для поиска изображений по текстовому запросу. 2 http://alipr.com - он-лайн система для аннотирования изображений и поиска по визуально- . 3 http://mirflickr08.com , Cross-Media Relevance Model (CMRM) - рением класса языковых моделей, осуществляющих многоязычный текстовый поиск, на случай аннотирования изображений, т.е поиск на двух «языках»: естественном языке и языке низкоуровневых характеристик изображений. Так как языковые модели являются сравнительно простым в реализации и в то же время хорошо зарекомендовавшим себя в информационном поиске классом моделей, в данной ди- CMRM оценки распределения слов и визуальных признаков изображений. Все этапы поставленной задачи были адгоритмизованны и реализованы программно с целью проведения общего вычислительного эксперимента, направленного на оценку параметров модели и проверку ее работоспособности для реальной . Построение словаря визуальных признаков на основе глобальных характеристик изображений Цветовые гистограммы изображений Распределение цветов на изображении - очень важная для зрительного восприятия человека характеристика. Эксперименты по изучению психофизиологических особенностей человеческого зрения [8, 9] показали, что распределения цветов на изображении бывает достаточно для различения типов сцен и многих типов . Поэтому большое значение для вычисления цветовых характеристик имеет выбор цветового пространства. Примером цветового пространства, цвета в котором хорошо согласуются с человеческим восприятием цвета, является пространство ClELab. При разработке ClELab преследовалась цель создания цветового про, - , - ных областях цветового пространства будет производить одинаковое ощущение . - ность восприятия цвета человеком. Смысл цветовых компонентов точки в пространстве ClELab состоит в сле-. L (lightness) , - - a b. цвета в диапазоне от зеленого до пурпурного, вторая - от синего до желтого. Преобразование из промежуточного пространства CIE XYZ[] в ClELab осуществляется : L = 116 f (Y/Yn) -16, a = 500[ f (Х/Хя) - f (Y/Yn)], b = 200[ f (Y/Yn) - f (Z/Zn)], Xn , Yn Zn - ClE XYZ, - дартного осветителя D50 они равны: X =96.42, Y =100, Z =82.49. n ’ n ’ n 1/3 . ^ /г /лп\3 f (t ) = /2^2 V 6 На основе пространства CIELab вводится пространство CIELCh, в котором компонента L остается такой же, как и в CIELab, а компоненты C (Chroma) и h (hue) рассчитываются следующим образом: C = (a2 + Г) 2 \1/2 h = a Характеристика однородности фона изображений Для различения типов сцен также может быть полезен признак, характеризующий однородность изображения и его фон. Наличие так называемого фона -областей компактно расположенных пикселей, обладающих примерно одинаковыми цветовыми признаками, является важной характеристикой, сильно влияющей на восприятие изображения. Для вычисления признака содержания фона (Б£) предлагается использовать комбинацию методов, предложенных в статьях [11, 12]. Признаком отсутствия у изображения фона можно считать равномерность его гистограммы. Рассмотрим цветное изображение I размером Х1 X У1, имеющее три цветовые компоненты Iя, Iе, 1Б, I = 1,.., X,, / = 1,.., У для Я, О, Б с о!]!]!] ’ ’ 1 ^ ’ ’ 1 . {0,1,..., М}. В качестве численной оценке степени равномерности гистограмм цветовых компонент НЯ, Н°, НБ, I = 0,...,М можно использовать энтропию как меру информативности каждого из столбцов гистограммы: M Ex = Н,*, x = R,G,B, i = 0,...,M, i=0 где Hx 'xY log если Hf= 0, если Hx Ф 0. На основании полученного значения энтропии определяется признак содержания фона в каждой из цветовых компонент изображения: Bx =1 Ex log M x = R,G,B. а также для всего изображения: Б = БЯБОББ. В [11] , - ным к конкретному цвету и интенсивности фона, а также к контрасту информативной части изображения по отношению к окружающему ее фону и будет изменяться в пределах от 0 до 1. Для достижения монотонного изменения признака относительно процентного отношения пикселей, принадлежащих фону, для изображений, содержащих шум или подвергшихся сжатию, в процессе вычислительных экспериментов была использована предварительная обработка изображений медианным фильтром. Полученное в ходе эксперимента типичное значение признака для фотографий реальных сцен лежит в пределах 0,08 - 0,15. Текстурные признаки изображений Текстура является очень важным с точки зрения восприятия и распознавания объектов человеком свойством изображений [13]. На многих изображениях она позволяет определять свойства областей, критически важные для корректного выполнения анализа содержания изображения. Свойства, отвечающие человеческому восприятию, имеют текстурный признак Tamura, введенный Hideyuki Tamura в [14]. Введенный текстурный признак включает такие характеристики, как грубость (coarseness), контраст (contrast), направленность (directionality) текстуры. , , -, . всем точкам (x, у) изображения размер Sbest (x, у) окна, в котором абсолютные разности между парами средних интенсивностей, вычисленных в горизонтальном и вертикальном направлениях относительно текущей точки, максимальны: Признак, характеризующий контраст, является показателем того, как уровни пени их распределение смещено к белому или черному. Для вычисления контраста используются центральные моменты второго 7 и четвертого ¿и4 порядков гистограммы уровней серого изображения, и значение признака определяется как: Ещё одним признаком текстуры согласно Татига является направленность. Этот признак вычисляется с использованием значений величин и направлений градиента интенсивности в точках изображения, Строится гистограмма направлений градиента ИЛг (в), и в качестве признака затем используется либо сама эта гистограмма, либо вычисляется степень направленности, связанная с величинами пиков гистограммы: Г - нормализующий множитель. Признак лучше использовать для изображений, содержащих одну , , -ные характеристики, содержат, как правило, несколько типов текстур. Поэтому в качестве признака направленности для них было решено использовать вместо одного признака ЕЛг гистограмму ИЛг. В экспериментах была использована гистограмма с 16 ячейками. M N F.r, = HSs„ (i, j). серого q : q =1,2,..., qmax варьируются в пределах изображения I и в ка кой сте- max F con II (-gp ) Hdir (»)• npeaks p=1 OeWp где n - число пиков гистошаммы. больших некотопого попога.. Й - соответ- ствующее p -му пику значение угла Й, Wp - некоторая окрестность p -го пика, Гистограммы ориентаций градиентов В рассматриваемом виде эти дескрипторы (Histogram of oriented gradients -HoG) были впервые предложены и описаны исследователями Navneet Dalal и Bill Triggs в работах [15, 16]. Основанием рассматриваемого метода построения дескрипторов на основе HoG является то, что наличие и форма локальных объектов на изображении могут быть описаны распределением интенсивности градиентов. Изображение делится на малые регионы — «клетки», для каждой клетки составляется гистограмма направлений градиентов точек этой клетки. Комбинация этих гистограмм и представляет собой дескриптор. Существует несколько типов дескрипторов, наиболее часто используемым является прямоугольный дескриптор - R-HoG (рис. 2). Использованный в эксперименте дескриптор имеет 3 X 3 клеток, 4 блока, включающих 4 клетки и 9 ячеек гистограммы. cell block Рис. 2. Прямоугольный дескриптор R-HoG Для улучшения качества детекции локальные гистограммы могут быть нормализованы по контрасту путем вычисления меры интенсивности по большему региону изображения, т.н. блоку, и использования этого значения для нормализации гистограмм всех клеток в блоке. Такая нормализация ведет к лучшей инвариантности относительно изменений освещенности и теням. Авторы, предлагающие дескрипторы HoG, подчеркивают преимущество этого похожа по сравнению с подобными подходами edge orientation histograms, scale-invariant feature transform descriptors, shape contexts. Составление словаря визуальных признаков Описанные выше признаки изображений были использованы автором данной работы для поиска по визуальному подобию в [17, 18], что позволило на порядок повысить точность поиска по сравнению с другими ранее используемыми призна-. Для построения модели аннотирования нам необходимо составить «словарь», из используемых признаков с помощью некоторого алгоритма кластеризации (в ходе эксперимента использовались известные алгоритмы k-means и k-medoids). Будем строить словарь признаков размером N, в котором присутствует некоторое количество N k . - , , . 1. - значение каждого признака состоит из его названия и длины получаемого вектора. Таблица 1 Состав словаря визуальных признаков Название признака Длина вектора Признаков в словаре Bg -1 1 10 ИоО - 144 144 20 ЯОВ - 256 256 20 С1Е1СИ - 60 60 20 Татига - 18 18 20 Всего 90 признаков Вероятностная модель автоматического аннотирования Перейдем теперь к рассмотрению вероятностной модели. Пусть J=Ъ } - представление нового неаннотированного изображения с помощью признаков из словаря признаков Ъ1 е B. Мы хотим выбрать набор ключевых слов {ч,,...,Ч}, Ч е Ж, которые наиболее адекватно описывают содержа. Для построения вероятностной модели аннотирования можно перенести под, -, . , каждого документа й строится модель М л, предположим, что для каждого изображения I можно построить модель М1, так называемую модель релевантности для I. Модель М: представляет собой вероятностное распределение Р(11), которое содержит все возможные слова и признаки из словаря признаков В и словаря слов Ж обучающей выборки. Модель релевантности Мй будем рассматривать как «черный ящик», содержащий все возможные признаки, которые могут появиться у изображения I, и все возможные слова, которые могут появиться в его аннотации. Представление изображения в виде набора признаков {Ъ,,..., Ъ&} тогда можно рассматривать как случайную выборку из этой модели. Для присвоения изображению J ключевых слов {ч,,...,м>(} согласно принципу ранжирования по вероятности, мы должны оценить вероятности Р(ч | J) для каждого ключевого слова Ч из словаря, т. е. оценить вероятности: Р(ч 11) « Р (ч^,..., Ъх). Следуя идее моделировать каждое изображение как «черный ящик», предположим, что появление Ч и Ъ,,...,Ъ на изображении - события взаимно незави- , Ч и признаков Ъ,,..., Ъ как: Р(ч,Ъ,,...,Ъ) = £Р(!)Р(ч 11)ХЛр(Ъ1 11). 1е<2 ¿=1 Считая распределение изображений в обучающей выборке равномерным, отбросим Р(1). Таким образом, благодаря сделанным предположениям о независимости, нахождение модели релевантности М: сводится к нахождению оценок Р(ч 11) и Р(Ъ 11) для термов словарей ключевых слов и визуальных признаков соответственно. В качестве моделей, соответствующих распределениям признаков и слов, можно использовать языковые модели. Соответствующие языковым моделям линейные интерполяционные оценки вероятностей имеют вид: Р,(,,.|1 ) = (1-а,) ^ + а,В:Ш, РЛЪЦ ) = (!-в) ^ +А™, где N(ч, I) обозначает число раз, которое слово Ч встречается в аннотации изображения I, N(Ч, О) - сколько раз оно появляется во всех аннотациях обучающей выборки, 111 - общее количество слов и признаков у изображения I, | О | - общее количество изображений в обучающей выборке. N(Ъ,I) и N(Ъ, О) обозначают то же самое для признаков соответственно. Параметры сглаживания 0< а1 <1 и 0< в: <1 для слов и признаков изображений соответственно должны выбираться для каждого изображения I е О отдельно. Используются разные параметры для модели слов и модели признаков, потому что вероятностные распределения слов и термов в общем случае отличаются. Распределение слов подчинено закону Зипфа, распределение же признаков в словаре признаков зависит от метода кластеризации, применяющегося для построения этого словаря, и является более равномерным. Возникает проблема выбора параметров а, в. Обе модели можно представить как языковые модели, поэтому для нахождения параметров можно воспользо-[19] предлагается выбирать для подобных языковых моделей параметр сглаживания в диапазоне от 0,6 до0,8. Но, так как распределения слов и признаков различны и имеют специфику обучающей выборки, отличающую их от обычных слов в тексте, моделирующихся языковыми моделями, в данном случае лучшим вариантом будет найти эти параметры на основе обучающей выборки. Для этого в данной работе предлагается модифицированный метод максимизации энтропии сглаженного распределения слов: вы- | О | - размер обучающей выборки, I. е О, ] = 1, к, | О | - входящие в эту борку изображения, t - оцениваемый терм (слово, признак), Ря зависит от кон. частоты появления в обучающей выборке такой подход позволяет значительно сократить время вычисления оптимальных параметров. Для нахождения параметров согласно этому подходу необходимо для каждого значения параметра из некоторого диапазона вычислить величину энтропии и взять в качестве оптимального , . , изображений большой коллекции, мы можем производить поиск по запросу из , -кающимися с запросом аннотациями. Выводы water, sun, landscape, outdoor, lake tree, landscape, night, city, sky, cloud, nature Puc. 3. Пример работы алгоритма В данной работе предложена улучшенная вероятностная модель аннотирования изображений, построенная на основе наиболее дискриминативных глобальных признаков изображений, которые позволяют эффективно различать не только типы , . нахождения параметров сглаживания модели. Проведен ряд вычислительных экс, доказывающих вычислительную эффективность предложенных методов. Примеры результатов работы предложенного метода приведены на рис. 3. ]]></text>
</doc>
